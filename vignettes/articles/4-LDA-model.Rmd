---
title: "4 LDA model"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, message=FALSE, warning=FALSE}
library(rfintext)
library(quanteda)
library(topicmodels)
library(topicdoc)
library(dplyr)
library(doFuture)
plan(multisession)
```

```{r}
dtm <- aspol |>
  preprocess_corpus() |>
  corpus_to_dtm(kunta, LEMMA)
```
Optimal values for k are 2, 6, 9 and 16.

```{r}
k_values <- c(2, 6, 9, 16)
results <- foreach(k = k_values) %dofuture% {
  topicmodels::LDA(quanteda::convert(dtm, to = "tm"), k = k, control = list(seed = 1234))
}
names(results) <- paste0("k_", k_values)
```

```{r}
results
```

```{r}
lapply(results, topic_diagnostics, dtm)
```


```{r, rows.print=25}
lapply(results, function(x) as.data.frame(terms(x, 25)))
```



