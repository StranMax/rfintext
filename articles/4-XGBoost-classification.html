<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rfintext">
<title>4 XGBoost classification • rfintext</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4 XGBoost classification">
<meta property="og:description" content="rfintext">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rfintext</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/0-Preprocessing-PDF-docs.html">0 Preprocessing PDF-docs</a>
    <a class="dropdown-item" href="../articles/1-Asuntopoliittisten-ohjelmien-teko-kunnissa.html">1 Asuntopoliittisten ohjelmien teko kunnissa</a>
    <a class="dropdown-item" href="../articles/1-Data-preprocessing.html">1 Data preprocessing</a>
    <a class="dropdown-item" href="../articles/2-Document-term-matrix.html">2 Document term matrix</a>
    <a class="dropdown-item" href="../articles/3-Topic-modeling.html">3 Topic modeling</a>
    <a class="dropdown-item" href="../articles/4-XGBoost-classification.html">4 XGBoost classification</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/StranMax/rfintext/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>4 XGBoost classification</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/StranMax/rfintext/blob/HEAD/vignettes/articles/4-XGBoost-classification.Rmd" class="external-link"><code>vignettes/articles/4-XGBoost-classification.Rmd</code></a></small>
      <div class="d-none name"><code>4-XGBoost-classification.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/StranMax/rfintext" class="external-link">rfintext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/StranMax/rfinstats" class="external-link">rfinstats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/juliasilge/tidytext" class="external-link">tidytext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost" class="external-link">xgboost</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">topicmodels</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quanteda.io" class="external-link">quanteda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">aspol</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">kunta</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">taantuvat</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">luokka</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>luokka <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_collapse.html" class="external-link">fct_collapse</a></span><span class="op">(</span><span class="va">luokka</span>,</span>
<span>                                        Kasvava <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Voimakkaasti kasvava"</span>,</span>
<span>                                                    <span class="st">"Kasvava"</span>,</span>
<span>                                                    <span class="st">"Hieman kasvava"</span><span class="op">)</span>, </span>
<span>                                        Taantuva <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hieman taantuva"</span>,</span>
<span>                                                     <span class="st">"Taantuva"</span>,</span>
<span>                                                     <span class="st">"Voimakkaasti taantuva"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 66 × 5</span></span></span>
<span><span class="co">#&gt;    kunta        vaesto kokmuutos_2010_2022 suht_muutos_2010_2022 luokka  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Enontekiö     <span style="text-decoration: underline;">1</span>858                  -<span style="color: #BB0000;">71</span>                 -<span style="color: #BB0000;">3.82</span> Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Espoo       <span style="text-decoration: underline;">275</span>040.               <span style="text-decoration: underline;">60</span>944                 22.2  Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Eura         <span style="text-decoration: underline;">11</span>971.               -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">278</span>                -<span style="color: #BB0000;">10.7</span>  Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Hartola       <span style="text-decoration: underline;">2</span>934.                -<span style="color: #BB0000;">814</span>                -<span style="color: #BB0000;">27.7</span>  Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Hattula       <span style="text-decoration: underline;">9</span>582.                -<span style="color: #BB0000;">266</span>                 -<span style="color: #BB0000;">2.78</span> Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Helsinki    <span style="text-decoration: underline;">631</span>479.               <span style="text-decoration: underline;">80</span>678                 12.8  Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Huittinen    <span style="text-decoration: underline;">10</span>286.                -<span style="color: #BB0000;">955</span>                 -<span style="color: #BB0000;">9.28</span> Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Hyvinkää     <span style="text-decoration: underline;">46</span>322.                <span style="text-decoration: underline;">1</span>527                  3.30 Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Hämeenlinna  <span style="text-decoration: underline;">67</span>687.                <span style="text-decoration: underline;">1</span>588                  2.35 Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Iitti         <span style="text-decoration: underline;">6</span>821.                -<span style="color: #BB0000;">557</span>                 -<span style="color: #BB0000;">8.17</span> Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Imatra       <span style="text-decoration: underline;">27</span>274.               -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">468</span>                -<span style="color: #BB0000;">12.7</span>  Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Inkoo         <span style="text-decoration: underline;">5</span>479.                -<span style="color: #BB0000;">225</span>                 -<span style="color: #BB0000;">4.11</span> Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Joensuu      <span style="text-decoration: underline;">75</span>637.                <span style="text-decoration: underline;">4</span>809                  6.36 Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> Juva          <span style="text-decoration: underline;">6</span>398.               -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">295</span>                -<span style="color: #BB0000;">20.2</span>  Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> Järvenpää    <span style="text-decoration: underline;">41</span>928.                <span style="text-decoration: underline;">6</span>922                 16.5  Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> Kaarina      <span style="text-decoration: underline;">33</span>010.                <span style="text-decoration: underline;">5</span>088                 15.4  Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> Kalajoki     <span style="text-decoration: underline;">12</span>516.                -<span style="color: #BB0000;">205</span>                 -<span style="color: #BB0000;">1.64</span> Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> Kauniainen    <span style="text-decoration: underline;">9</span>511.                <span style="text-decoration: underline;">1</span>667                 17.5  Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> Kemiönsaari   <span style="text-decoration: underline;">6</span>854.                -<span style="color: #BB0000;">749</span>                -<span style="color: #BB0000;">10.9</span>  Taantuva</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> Kerava       <span style="text-decoration: underline;">35</span>764.                <span style="text-decoration: underline;">3</span>843                 10.7  Kasvava </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">aspol</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/preprocess_corpus.html">preprocess_corpus</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/corpus_to_dtm.html">corpus_to_dtm</a></span><span class="op">(</span><span class="va">kunta</span>, <span class="va">LEMMA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://quanteda.io/reference/dfm_subset.html" class="external-link">dfm_subset</a></span><span class="op">(</span><span class="va">docname_</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">y</span><span class="op">$</span><span class="va">kunta</span><span class="op">)</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; Document-feature matrix of: 66 documents, 3,061 features (76.84% sparse) and 0 docvars.</span></span>
<span><span class="co">#&gt;              features</span></span>
<span><span class="co">#&gt; docs          A#talo III Vapaa#aika aiheuttaa aika aika#väli ajatella ala alhainen alku alku#peräinen alku#puoli antaa arava#laina arava#rajoitus arvioida asettaa asia asiakas asian#mukainen</span></span>
<span><span class="co">#&gt;   Enontekiö        3   1          1         3    7         1        1   1        1    1             1          1     3           1              1        1       2    3       3              1</span></span>
<span><span class="co">#&gt;   Espoo            0   0          0         1   18         3        0   3        4    1             1          0     2           0              0        9      10    3       1              0</span></span>
<span><span class="co">#&gt;   Eura             0   0          0         1    5         0        0   0        1    0             0          0     1           0              0        3       1    1       6              0</span></span>
<span><span class="co">#&gt;   Hartola          0   0          1         2    5         0        0   1        0    0             0          0     0           0              0        3       0    0       0              0</span></span>
<span><span class="co">#&gt;   Hattula          0   0          0         0    6         0        0   0        0    1             0          0     1           0              0        0       1    1       0              0</span></span>
<span><span class="co">#&gt;   Helsinki         0   0          0         3   46         4        0   5        5   12             0          1     7           0              0       26      13    8       6              1</span></span>
<span><span class="co">#&gt;   Huittinen        2   0          0         0   13         1        5   2        2    0             0          0     3           0              0        4       3   13       4              0</span></span>
<span><span class="co">#&gt;   Hyvinkää         0   0          0         0    1         0        0   0        0    0             0          0     0           0              0        1       0    0       0              0</span></span>
<span><span class="co">#&gt;   Hämeenlinna      0   0          3         3    1         0        0   2        0    1             0          0     3           0              0        2       0   29       3              0</span></span>
<span><span class="co">#&gt;   Iitti            0   0          0         0    0         0        0   0        0    1             0          0     5           0              0        0       1    0       0              0</span></span>
<span><span class="co">#&gt;   Imatra           0   0          0         0    2         0        0   1        0    0             0          0     0           0              0        2       0    1       0              0</span></span>
<span><span class="co">#&gt;   Inkoo            0   0          0         1   11         1        0   0        1    2             0          0     4           0              0        0       5    2       0              0</span></span>
<span><span class="co">#&gt;   Joensuu          0   0          0         1   33         2        1   0        4    4             1          0     2           0              1        9      13    5       4              0</span></span>
<span><span class="co">#&gt;   Juva             0   0          0         2   13         5        0   1        2    3             0          0     2           1              0        1       2    2       3              0</span></span>
<span><span class="co">#&gt;   Järvenpää        0   0          0         0    2         0        0   0        0    0             0          0     1           0              0        0       3    2       0              0</span></span>
<span><span class="co">#&gt;   Kaarina          0   0          1         2   15         6        0   0        0    1             0          0     4           0              0        4       4    3       0              0</span></span>
<span><span class="co">#&gt;   Kalajoki         0   0          0         0    1         0        0   0        0    0             0          0     0           0              0        2       0    0       0              0</span></span>
<span><span class="co">#&gt;   Kauniainen       0   0          0         2   14         0        1   0        0    1             0          1     4           0              0       12       6    1       3              0</span></span>
<span><span class="co">#&gt;   Kemiönsaari      0   0          3         3   12         1        1   1        1    3             2          0    14           0              0        3       3    1       2              0</span></span>
<span><span class="co">#&gt;   Kerava           0   0          0         2    0         0        0   0        0    0             0          0     3           0              0        2       5    0       0              0</span></span>
<span><span class="co">#&gt; [ reached max_ndoc ... 46 more documents, reached max_nfeat ... 3,041 more features ]</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">optimal_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">lda_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>k <span class="op">=</span> <span class="va">optimal_k</span><span class="op">)</span> <span class="op"><a href="https://doFuture.futureverse.org/reference/grapes-dofuture-grapes.html" class="external-link">%dofuture%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/get_doc_topic_prob.html">get_doc_topic_prob</a></span><span class="op">(</span><span class="va">X</span>, k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   2.071   0.070  56.962</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lda_models</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"k_"</span>, <span class="va">optimal_k</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lda_models</span></span>
<span><span class="co">#&gt; $k_5</span></span>
<span><span class="co">#&gt; Document-feature matrix of: 66 documents, 5 features (0.00% sparse) and 0 docvars.</span></span>
<span><span class="co">#&gt;              features</span></span>
<span><span class="co">#&gt; docs                     1            2            3            4            5</span></span>
<span><span class="co">#&gt;   Enontekiö   8.606223e-05 8.606244e-05 9.996557e-01 8.606532e-05 8.606483e-05</span></span>
<span><span class="co">#&gt;   Espoo       6.123387e-01 3.875888e-01 2.416384e-05 2.416435e-05 2.416383e-05</span></span>
<span><span class="co">#&gt;   Eura        8.310256e-05 8.311158e-05 8.603327e-01 8.310812e-05 1.394180e-01</span></span>
<span><span class="co">#&gt;   Hartola     1.015523e-04 4.119933e-02 9.584960e-01 1.015670e-04 1.015596e-04</span></span>
<span><span class="co">#&gt;   Hattula     2.224271e-01 1.345043e-04 1.292242e-01 3.728322e-01 2.753820e-01</span></span>
<span><span class="co">#&gt;   Helsinki    1.227323e-05 9.999509e-01 1.227255e-05 1.227257e-05 1.227253e-05</span></span>
<span><span class="co">#&gt;   Huittinen   4.123488e-02 3.371053e-02 2.181909e-01 3.607065e-01 3.461573e-01</span></span>
<span><span class="co">#&gt;   Hyvinkää    4.351080e-02 4.342484e-01 1.878331e-04 1.496725e-01 3.723805e-01</span></span>
<span><span class="co">#&gt;   Hämeenlinna 4.344616e-05 1.818009e-02 4.069894e-01 2.753202e-01 2.994669e-01</span></span>
<span><span class="co">#&gt;   Iitti       6.114263e-01 2.092173e-04 3.621206e-01 2.603466e-02 2.092140e-04</span></span>
<span><span class="co">#&gt;   Imatra      2.408684e-04 3.992987e-01 2.408956e-04 3.754274e-01 2.247921e-01</span></span>
<span><span class="co">#&gt;   Inkoo       6.525282e-01 4.518005e-02 5.826246e-05 1.392811e-01 1.629523e-01</span></span>
<span><span class="co">#&gt;   Joensuu     7.365549e-02 1.868584e-01 2.737192e-02 4.128733e-01 2.992409e-01</span></span>
<span><span class="co">#&gt;   Juva        5.972653e-05 5.973280e-05 9.997611e-01 5.973343e-05 5.973663e-05</span></span>
<span><span class="co">#&gt;   Järvenpää   1.106307e-04 6.594140e-01 1.106293e-04 2.600977e-01 8.026703e-02</span></span>
<span><span class="co">#&gt;   Kaarina     7.894466e-01 1.040432e-01 3.239381e-05 3.239659e-05 1.064454e-01</span></span>
<span><span class="co">#&gt;   Kalajoki    6.766848e-04 4.731515e-01 1.204212e-01 2.859377e-01 1.198129e-01</span></span>
<span><span class="co">#&gt;   Kauniainen  2.912906e-01 5.337143e-01 4.672361e-02 2.534518e-02 1.029263e-01</span></span>
<span><span class="co">#&gt;   Kemiönsaari 9.428661e-01 2.758007e-05 5.705113e-02 2.758330e-05 2.758213e-05</span></span>
<span><span class="co">#&gt;   Kerava      9.997232e-01 6.919711e-05 6.918496e-05 6.919125e-05 6.919199e-05</span></span>
<span><span class="co">#&gt; [ reached max_ndoc ... 46 more documents ]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_15</span></span>
<span><span class="co">#&gt; Document-feature matrix of: 66 documents, 15 features (0.00% sparse) and 0 docvars.</span></span>
<span><span class="co">#&gt;              features</span></span>
<span><span class="co">#&gt; docs                     1            2            3            4            5            6            7            8            9           10           11           12           13           14           15</span></span>
<span><span class="co">#&gt;   Enontekiö   1.679843e-05 1.679843e-05 9.997648e-01 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05 1.679843e-05</span></span>
<span><span class="co">#&gt;   Espoo       3.943024e-03 4.715534e-06 4.715534e-06 4.715534e-06 4.715534e-06 4.715534e-06 7.406924e-01 4.715534e-06 2.553080e-01 4.715534e-06 4.715534e-06 4.715534e-06 4.715534e-06 4.715534e-06 4.715534e-06</span></span>
<span><span class="co">#&gt;   Eura        1.622202e-05 1.622202e-05 9.378262e-01 1.622202e-05 1.622202e-05 1.622202e-05 1.622202e-05 6.196288e-02 1.622202e-05 1.622202e-05 1.622202e-05 1.622202e-05 1.622202e-05 1.622202e-05 1.622202e-05</span></span>
<span><span class="co">#&gt;   Hartola     1.982413e-05 1.982413e-05 9.997225e-01 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05 1.982413e-05</span></span>
<span><span class="co">#&gt;   Hattula     1.372363e-01 2.625442e-05 2.625442e-05 2.625442e-05 2.625442e-05 2.625442e-05 2.625442e-05 2.625442e-05 2.625442e-05 2.625442e-05 3.133042e-01 2.199454e-01 1.580278e-01 2.625442e-05 1.712238e-01</span></span>
<span><span class="co">#&gt;   Helsinki    2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 9.999665e-01 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06 2.395043e-06</span></span>
<span><span class="co">#&gt;   Huittinen   8.052335e-06 8.052335e-06 8.740043e-02 8.052335e-06 8.052335e-06 8.052335e-06 8.052335e-06 8.052335e-06 8.052335e-06 8.052335e-06 1.742530e-01 8.052335e-06 8.052335e-06 8.052335e-06 7.382499e-01</span></span>
<span><span class="co">#&gt;   Hyvinkää    1.728037e-01 1.143897e-01 3.666711e-05 3.666711e-05 3.666711e-05 3.666711e-05 3.666711e-05 3.308893e-01 3.666711e-05 3.815139e-01 3.666711e-05 3.666711e-05 3.666711e-05 3.666711e-05 3.666711e-05</span></span>
<span><span class="co">#&gt;   Hämeenlinna 8.479025e-06 3.341023e-02 1.712503e-02 8.479025e-06 1.687146e-02 8.479025e-06 8.479025e-06 8.479025e-06 8.479025e-06 7.798250e-01 8.479025e-06 1.085918e-01 8.479025e-06 4.410009e-02 8.479025e-06</span></span>
<span><span class="co">#&gt;   Iitti       4.084273e-05 4.084273e-05 4.084273e-05 2.902966e-02 7.970549e-02 8.268938e-01 4.084273e-05 4.084273e-05 6.392182e-02 4.084273e-05 4.084273e-05 4.084273e-05 4.084273e-05 4.084273e-05 4.084273e-05</span></span>
<span><span class="co">#&gt;   Imatra      4.702945e-05 4.702945e-05 4.702945e-05 4.702945e-05 4.702945e-05 4.702945e-05 4.702945e-05 4.702945e-05 4.702945e-05 9.623616e-01 4.702945e-05 4.702945e-05 4.702945e-05 3.702700e-02 4.702945e-05</span></span>
<span><span class="co">#&gt;   Inkoo       6.226447e-01 1.137132e-05 1.137132e-05 1.137132e-05 1.137132e-05 1.027854e-01 1.137132e-05 1.137132e-05 1.137132e-05 2.018057e-01 1.137132e-05 1.137132e-05 7.263912e-02 1.137132e-05 1.137132e-05</span></span>
<span><span class="co">#&gt;   Joensuu     3.770942e-06 3.770942e-06 3.770942e-06 3.770942e-06 3.770942e-06 3.770942e-06 7.360047e-02 3.770942e-06 3.770942e-06 5.386418e-01 3.770942e-06 3.770942e-06 3.770942e-06 1.460087e-01 2.417076e-01</span></span>
<span><span class="co">#&gt;   Juva        1.165810e-05 1.165810e-05 9.998368e-01 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05 1.165810e-05</span></span>
<span><span class="co">#&gt;   Järvenpää   2.159393e-05 2.159393e-05 2.159393e-05 2.159393e-05 2.159393e-05 2.159393e-05 2.159393e-05 1.820316e-01 9.147967e-02 2.159393e-05 2.159393e-05 6.420998e-02 2.159393e-05 6.620412e-01 2.159393e-05</span></span>
<span><span class="co">#&gt;   Kaarina     7.925062e-01 6.322104e-06 6.322104e-06 6.322104e-06 2.074116e-01 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06 6.322104e-06</span></span>
<span><span class="co">#&gt;   Kalajoki    1.436383e-01 1.322321e-04 1.104014e-01 1.322321e-04 1.322321e-04 1.322321e-04 1.322321e-04 1.322321e-04 1.588870e-01 1.322321e-04 1.322321e-04 1.322321e-04 1.322321e-04 1.322321e-04 5.856187e-01</span></span>
<span><span class="co">#&gt;   Kauniainen  6.819530e-06 6.819530e-06 6.819530e-06 6.819530e-06 6.819530e-06 6.819530e-06 6.819530e-06 6.819530e-06 1.483970e-02 6.819530e-06 6.819530e-06 6.819530e-06 9.850716e-01 6.819530e-06 6.819530e-06</span></span>
<span><span class="co">#&gt;   Kemiönsaari 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 9.999246e-01 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06 5.383026e-06</span></span>
<span><span class="co">#&gt;   Kerava      9.998109e-01 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05 1.350486e-05</span></span>
<span><span class="co">#&gt; [ reached max_ndoc ... 46 more documents ]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_18</span></span>
<span><span class="co">#&gt; Document-feature matrix of: 66 documents, 18 features (0.00% sparse) and 0 docvars.</span></span>
<span><span class="co">#&gt;              features</span></span>
<span><span class="co">#&gt; docs                     1            2            3            4            5            6            7            8            9           10           11           12           13           14           15           16           17           18</span></span>
<span><span class="co">#&gt;   Enontekiö   1.299809e-05 1.299809e-05 9.997790e-01 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05 1.299809e-05</span></span>
<span><span class="co">#&gt;   Espoo       1.048575e-02 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 2.222091e-01 3.648683e-06 7.672504e-01 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06 3.648683e-06</span></span>
<span><span class="co">#&gt;   Eura        1.255207e-05 1.255207e-05 8.854954e-01 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.255207e-05 1.143038e-01 1.255207e-05</span></span>
<span><span class="co">#&gt;   Hartola     1.533932e-05 1.533932e-05 9.940542e-01 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 1.533932e-05 5.700389e-03 1.533932e-05 1.533932e-05</span></span>
<span><span class="co">#&gt;   Hattula     1.391091e-01 2.031504e-05 2.031504e-05 1.349516e-01 2.031504e-05 2.031504e-05 2.031504e-05 6.140553e-02 2.031504e-05 2.031504e-05 2.958494e-01 2.097024e-01 1.587382e-01 2.031504e-05 2.031504e-05 2.031504e-05 2.031504e-05 2.031504e-05</span></span>
<span><span class="co">#&gt;   Helsinki    1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 1.853179e-06 9.999685e-01 1.853179e-06 1.853179e-06</span></span>
<span><span class="co">#&gt;   Huittinen   6.230581e-06 6.230581e-06 1.811657e-02 9.835076e-02 6.230581e-06 6.230581e-06 6.230581e-06 6.230581e-06 6.230581e-06 6.230581e-06 1.839712e-01 6.230581e-06 6.230581e-06 6.230581e-06 6.994742e-01 6.230581e-06 6.230581e-06 6.230581e-06</span></span>
<span><span class="co">#&gt;   Hyvinkää    1.472571e-01 1.553885e-01 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05 3.135304e-01 2.837244e-05 3.834268e-01 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05 2.837244e-05</span></span>
<span><span class="co">#&gt;   Hämeenlinna 6.560740e-06 1.754107e-02 5.719255e-02 4.756925e-02 6.560740e-06 6.560740e-06 6.560740e-06 6.560740e-06 6.560740e-06 6.165323e-01 6.560740e-06 1.871120e-01 6.560740e-06 3.511489e-02 6.560740e-06 6.560740e-06 3.886575e-02 6.560740e-06</span></span>
<span><span class="co">#&gt;   Iitti       3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 8.139641e-01 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 3.160361e-05 9.147191e-02 5.964667e-02 3.447485e-02</span></span>
<span><span class="co">#&gt;   Imatra      3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05 2.599695e-01 3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05 7.394482e-01 3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05 3.639107e-05</span></span>
<span><span class="co">#&gt;   Inkoo       5.074923e-01 8.798713e-06 8.798713e-06 8.798713e-06 8.798713e-06 1.722328e-01 8.798713e-06 5.763348e-02 8.798713e-06 2.245221e-01 8.798713e-06 8.798713e-06 3.800494e-02 8.798713e-06 8.798713e-06 8.798713e-06 8.798713e-06 8.798713e-06</span></span>
<span><span class="co">#&gt;   Joensuu     2.917794e-06 2.917794e-06 2.917794e-06 2.917794e-06 2.917794e-06 2.917794e-06 2.039345e-02 2.917794e-06 2.917794e-06 8.057260e-01 2.917794e-06 2.917794e-06 2.917794e-06 3.066730e-03 1.707730e-01 2.917794e-06 2.917794e-06 2.917794e-06</span></span>
<span><span class="co">#&gt;   Juva        9.020618e-06 9.020618e-06 9.998466e-01 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06 9.020618e-06</span></span>
<span><span class="co">#&gt;   Järvenpää   1.670878e-05 1.670878e-05 1.670878e-05 1.670878e-05 1.670878e-05 1.670878e-05 1.670878e-05 2.000145e-01 1.670878e-05 1.670878e-05 1.670878e-05 1.670878e-05 1.670878e-05 7.607614e-01 1.670878e-05 3.897347e-02 1.670878e-05 1.670878e-05</span></span>
<span><span class="co">#&gt;   Kaarina     1.062195e-01 4.891787e-06 4.891787e-06 4.891787e-06 8.937023e-01 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06 4.891787e-06</span></span>
<span><span class="co">#&gt;   Kalajoki    2.050284e-01 1.023296e-04 1.433066e-01 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.023296e-04 1.753466e-01 4.748858e-01 1.023296e-04 1.023296e-04 1.023296e-04</span></span>
<span><span class="co">#&gt;   Kauniainen  5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 9.999103e-01 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06 5.276678e-06</span></span>
<span><span class="co">#&gt;   Kemiönsaari 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 9.999292e-01 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06 4.165163e-06</span></span>
<span><span class="co">#&gt;   Kerava      9.998224e-01 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05 1.044959e-05</span></span>
<span><span class="co">#&gt; [ reached max_ndoc ... 46 more documents ]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_21</span></span>
<span><span class="co">#&gt; Document-feature matrix of: 66 documents, 21 features (0.00% sparse) and 0 docvars.</span></span>
<span><span class="co">#&gt;              features</span></span>
<span><span class="co">#&gt; docs                     1            2            3            4            5            6            7            8            9           10           11           12           13           14           15           16           17           18           19           20</span></span>
<span><span class="co">#&gt;   Enontekiö   1.182627e-05 1.182627e-05 9.997635e-01 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05 1.182627e-05</span></span>
<span><span class="co">#&gt;   Espoo       2.428234e-02 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 8.899351e-02 3.319777e-06 8.866644e-01 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06 3.319777e-06</span></span>
<span><span class="co">#&gt;   Eura        1.142047e-05 1.142047e-05 9.735563e-01 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 1.142047e-05 2.622674e-02 1.142047e-05 1.142047e-05 1.142047e-05</span></span>
<span><span class="co">#&gt;   Hartola     1.395640e-05 1.395640e-05 7.349023e-01 1.395640e-05 1.395640e-05 2.648326e-01 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05 1.395640e-05</span></span>
<span><span class="co">#&gt;   Hattula     1.416460e-01 1.848342e-05 1.848342e-05 1.173190e-01 1.848342e-05 2.098230e-02 1.848342e-05 3.931001e-02 1.848342e-05 1.848342e-05 2.618716e-01 2.316703e-01 9.415671e-02 1.848342e-05 1.848342e-05 1.848342e-05 1.848342e-05 1.848342e-05 1.848342e-05 1.848342e-05</span></span>
<span><span class="co">#&gt;   Helsinki    1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06 9.999663e-01 1.686130e-06 1.686130e-06 1.686130e-06 1.686130e-06</span></span>
<span><span class="co">#&gt;   Huittinen   5.668917e-06 2.521769e-01 5.668917e-06 2.347533e-01 5.668917e-06 8.459530e-02 5.668917e-06 5.668917e-06 5.668917e-06 5.668917e-06 2.268407e-01 5.668917e-06 5.668917e-06 5.668917e-06 1.719354e-01 5.668917e-06 5.668917e-06 5.668917e-06 2.961340e-02 5.668917e-06</span></span>
<span><span class="co">#&gt;   Hyvinkää    2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 4.146677e-01 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 2.581414e-05 5.848419e-01 2.581414e-05</span></span>
<span><span class="co">#&gt;   Hämeenlinna 5.969311e-06 5.969311e-06 6.728307e-01 5.969311e-06 5.969311e-06 5.969311e-06 5.969311e-06 5.969311e-06 5.969311e-06 1.123070e-01 5.969311e-06 1.757731e-01 5.969311e-06 5.969311e-06 5.969311e-06 5.969311e-06 5.969311e-06 3.898767e-02 5.969311e-06 5.969311e-06</span></span>
<span><span class="co">#&gt;   Iitti       2.875386e-05 2.875386e-05 2.875386e-05 2.875386e-05 2.875386e-05 2.956050e-01 2.875386e-05 2.875386e-05 1.439365e-01 2.875386e-05 2.875386e-05 2.875386e-05 2.875386e-05 2.875386e-05 2.875386e-05 2.875386e-05 5.930096e-02 6.485691e-02 2.875386e-05 2.875386e-05</span></span>
<span><span class="co">#&gt;   Imatra      3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 9.993378e-01 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05 3.310944e-05</span></span>
<span><span class="co">#&gt;   Inkoo       8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.233246e-02 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 2.494317e-01 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06 8.005519e-06</span></span>
<span><span class="co">#&gt;   Joensuu     2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 1.982008e-03 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 9.979676e-01 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06 2.654775e-06</span></span>
<span><span class="co">#&gt;   Juva        8.207417e-06 8.207417e-06 9.998359e-01 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06 8.207417e-06</span></span>
<span><span class="co">#&gt;   Järvenpää   1.520237e-05 1.520237e-05 1.520237e-05 1.520237e-05 1.520237e-05 1.520237e-05 1.520237e-05 2.101349e-01 1.520237e-05 1.520237e-05 1.520237e-05 1.247352e-01 1.520237e-05 3.142443e-01 1.520237e-05 1.718328e-02 1.520237e-05 1.520237e-05 1.926832e-01 1.407911e-01</span></span>
<span><span class="co">#&gt;   Kaarina     4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 9.999110e-01 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06 4.450817e-06</span></span>
<span><span class="co">#&gt;   Kalajoki    3.150246e-01 5.986347e-01 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 8.466496e-02 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05 9.309507e-05</span></span>
<span><span class="co">#&gt;   Kauniainen  4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 9.999040e-01 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06 4.801010e-06</span></span>
<span><span class="co">#&gt;   Kemiönsaari 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06 3.789697e-06</span></span>
<span><span class="co">#&gt;   Kerava      9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.507553e-06 9.998098e-01 9.507553e-06</span></span>
<span><span class="co">#&gt; [ reached max_ndoc ... 46 more documents, reached max_nfeat ... 1 more feature ]</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xgb_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lda_models</span>, <span class="va">get_train_test_data</span>, <span class="va">y</span>, <span class="fu"><a href="../reference/split_train_test.html">split_train_test</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">luokka</span>, <span class="va">kunta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xgb_data</span></span>
<span><span class="co">#&gt; $k_5</span></span>
<span><span class="co">#&gt; $k_5$Train</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 47 x 5  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_5$Test</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 19 x 5  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_15</span></span>
<span><span class="co">#&gt; $k_15$Train</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 47 x 15  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_15$Test</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 19 x 15  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_18</span></span>
<span><span class="co">#&gt; $k_18$Train</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 47 x 18  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_18$Test</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 19 x 18  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_21</span></span>
<span><span class="co">#&gt; $k_21$Train</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 47 x 21  info: label  colnames: yes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_21$Test</span></span>
<span><span class="co">#&gt; xgb.DMatrix  dim: 19 x 21  info: label  colnames: yes</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>  booster <span class="op">=</span> <span class="st">"gbtree"</span>,</span>
<span>  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.4</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">9</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  subsample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  colsample_bylevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  nrounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  objective <span class="op">=</span> <span class="st">"binary:logistic"</span>,</span>
<span>  num_parallel_tree <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="va">gs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 9</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">gs_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xgb_data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">gs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>xgb_model <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="va">gs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="../reference/mod.html">mod</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"Train"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span>, .progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■                           </span>  14% |  ETA: 15s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■                     </span>  32% |  ETA: 12s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  49% |  ETA:  9s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  66% |  ETA:  6s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■      </span>  83% |  ETA:  3s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■                          </span>  15% |  ETA: 17s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■                      </span>  30% |  ETA: 14s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■                  </span>  45% |  ETA: 11s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■             </span>  61% |  ETA:  8s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■        </span>  76% |  ETA:  5s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   </span>  92% |  ETA:  2s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■                             </span>   8% |  ETA: 17s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■                        </span>  22% |  ETA: 16s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■                    </span>  36% |  ETA: 13s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  51% |  ETA: 10s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  66% |  ETA:  7s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■       </span>  81% |  ETA:  4s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  </span>  97% |  ETA:  1s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■                            </span>  12% |  ETA: 17s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■                       </span>  26% |  ETA: 15s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■                   </span>  41% |  ETA: 12s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■               </span>  54% |  ETA: 10s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■          </span>  69% |  ETA:  6s</span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■      </span>  85% |  ETA:  3s</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt; 259.769  17.662  77.413</span></span>
<span></span>
<span><span class="va">gs_list</span></span>
<span><span class="co">#&gt; $k_5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 10</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_15</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 10</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_18</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 10</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_21</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 10</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">xgb_data</span>, <span class="va">gs_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">xgb_dat</span>, <span class="va">xgb_mod</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">xgb_mod</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>error <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">xgb_model</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/compute_error.html">compute_error</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">xgb_dat</span><span class="op">[[</span><span class="st">"Test"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span>  <span class="op">)</span></span>
<span><span class="va">gs_list</span></span>
<span><span class="co">#&gt; $k_5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 11</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model  error</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_15</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 11</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model  error</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.474</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.474</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_18</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 11</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model  error</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k_21</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,268 × 11</span></span></span>
<span><span class="co">#&gt;    booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model  error</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> gbtree   0.01         3     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> gbtree   0.01         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> gbtree   0.01         3     0      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> gbtree   0.01         3     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> gbtree   0.01         3     0      0.5               0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gbtree   0.01         3     0      0.5               0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> gbtree   0.01         3     0      0.5               1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> gbtree   0.01         3     0      0.5               1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> gbtree   0.01         3     0      0.5               1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> gbtree   0.01         3     0      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> gbtree   0.01         3     0      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> gbtree   0.01         3     0      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> gbtree   0.01         3     0      0.75              0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> gbtree   0.01         3     0      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> gbtree   0.01         3     0      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> gbtree   0.01         3     0      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> gbtree   0.01         3     0      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> gbtree   0.01         3     0      0.75              1         45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> gbtree   0.01         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> gbtree   0.01         3     0      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.368</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,248 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">gs_list</span>, .id <span class="op">=</span> <span class="st">"lda_model"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">lda_model</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="4-XGBoost-classification_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="op">-</span><span class="va">error</span>, n <span class="op">=</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="va">lda_model</span>, with_ties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 89 × 12</span></span></span>
<span><span class="co">#&gt;    lda_model booster   eta max_depth gamma subsample colsample_bylevel nrounds objective       num_parallel_tree xgb_model  error</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> k_5       gbtree   0.01         5     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.158</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> k_5       gbtree   0.01         8     4      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.158</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> k_5       gbtree   0.31         3     0      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.158</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> k_15      gbtree   0.01         7     4      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.211</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> k_15      gbtree   0.31         7     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.211</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> k_18      gbtree   0.21         9     0      0.5               0.75       5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.211</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> k_21      gbtree   0.01         4     2      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> k_21      gbtree   0.01         6     2      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> k_21      gbtree   0.01         6     4      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> k_21      gbtree   0.01         7     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> k_21      gbtree   0.01         7     2      1                 0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> k_21      gbtree   0.11         3     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> k_21      gbtree   0.11         3     0      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> k_21      gbtree   0.11         3     2      0.5               0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> k_21      gbtree   0.11         3     2      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> k_21      gbtree   0.11         3     4      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> k_21      gbtree   0.11         4     0      1                 0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> k_21      gbtree   0.11         4     2      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> k_21      gbtree   0.11         4     2      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> k_21      gbtree   0.11         4     2      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span> k_21      gbtree   0.11         5     0      0.5               0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span> k_21      gbtree   0.11         5     0      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span> k_21      gbtree   0.11         5     2      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span> k_21      gbtree   0.11         5     4      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span> k_21      gbtree   0.11         6     2      0.75              0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">26</span> k_21      gbtree   0.11         6     2      0.75              0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">27</span> k_21      gbtree   0.11         6     2      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">28</span> k_21      gbtree   0.11         6     4      0.75              1         25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">29</span> k_21      gbtree   0.11         7     0      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">30</span> k_21      gbtree   0.11         7     2      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">31</span> k_21      gbtree   0.11         7     2      0.75              1          5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">32</span> k_21      gbtree   0.11         7     4      1                 0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">33</span> k_21      gbtree   0.11         8     0      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">34</span> k_21      gbtree   0.11         8     2      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">35</span> k_21      gbtree   0.11         8     4      1                 0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">36</span> k_21      gbtree   0.11         9     2      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">37</span> k_21      gbtree   0.11         9     2      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">38</span> k_21      gbtree   0.11         9     4      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">39</span> k_21      gbtree   0.11         9     4      0.75              0.75      45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">40</span> k_21      gbtree   0.21         3     2      0.5               0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">41</span> k_21      gbtree   0.21         3     2      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">42</span> k_21      gbtree   0.21         4     0      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">43</span> k_21      gbtree   0.21         4     2      0.75              0.5       25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">44</span> k_21      gbtree   0.21         4     2      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">45</span> k_21      gbtree   0.21         4     2      1                 0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">46</span> k_21      gbtree   0.21         4     4      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">47</span> k_21      gbtree   0.21         5     0      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">48</span> k_21      gbtree   0.21         5     2      1                 0.5       45 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">49</span> k_21      gbtree   0.21         5     4      0.75              0.75      25 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">50</span> k_21      gbtree   0.21         7     0      1                 0.5        5 binary:logistic                 2 <span style="color: #949494;">&lt;xgb.Bstr&gt;</span> 0.263</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 39 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># importance &lt;-  lapply(seq_along(xgb_models), function(i) {</span></span>
<span><span class="co">#   xgb.importance(</span></span>
<span><span class="co">#     feature_names = colnames(xgb_data[[i]]), </span></span>
<span><span class="co">#     model = xgb_models[[i]]</span></span>
<span><span class="co">#   )</span></span>
<span><span class="co"># }</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># names(importance) &lt;- paste0("k_", k_values)</span></span>
<span><span class="co"># importance</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># xgb_preds &lt;- lapply(seq_along(xgb_models), function(i) {</span></span>
<span><span class="co">#   xgb_preds &lt;- predict(xgb_models[[i]], xgb_data[[i]]$Test, reshape = TRUE)</span></span>
<span><span class="co">#   xgb_preds &lt;- as.data.frame(xgb_preds)</span></span>
<span><span class="co">#   </span></span>
<span><span class="co">#   colnames(xgb_preds) &lt;- levels(y$luokka)</span></span>
<span><span class="co">#   rownames(xgb_preds) &lt;- y$kunta[!y$kunta %in% trainNames]</span></span>
<span><span class="co">#   xgb_preds$PredictedClass &lt;- factor(colnames(xgb_preds)[max.col(xgb_preds, ties.method='first')], levels = levels(y$luokka))</span></span>
<span><span class="co">#   xgb_preds$ActualClass &lt;- factor(y[!y$kunta %in% trainNames, ]$luokka, levels = levels(y$luokka))</span></span>
<span><span class="co">#   xgb_preds</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># names(xgb_preds) &lt;- paste0("k_", k_values)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># xgb_preds</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># conf_matrix &lt;- lapply(seq_along(xgb_data), function(i) {</span></span>
<span><span class="co">#   confusionMatrix(xgb_preds[[i]]$ActualClass, xgb_preds[[i]]$PredictedClass)</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># names(conf_matrix) &lt;- paste0("k_", k_values)</span></span>
<span><span class="co"># conf_matrix</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Max Strandén.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
